#:kivy 1.10.1
#:import Factory kivy.factory.Factory

<CofirmAnswerPopup@Popup>:
    # auto_dismiss: False
    size_hint: 0.5, 0.5
    title: "É esta a tua resposta final?"
    BoxLayout:
        orientation: "vertical"
        Button:
            text: 'Sim'
            on_release:
                app.metagame.game.check()
                root.dismiss()
        Button:
            text: 'Não'
            on_release: root.dismiss()

<PublicHelpPopup@Popup>:
    # auto_dismiss: False
    size_hint: 0.5, 0.5
    title: "Public help"
    BoxLayout:
        orientation: "vertical"
        Label:
            text: 'A: %s%%' % app.metagame.game.public_perc["A"]
        Label:
            text: 'B: %s%%' % app.metagame.game.public_perc["B"]
        Label:
            text: 'C: %s%%' % app.metagame.game.public_perc["C"]
        Label:
            text: 'D: %s%%' % app.metagame.game.public_perc["D"]

<FriendHelpAnswerPopup@Popup>:
    # auto_dismiss: False
    size_hint: 0.95, 0.5
    title: app.metagame.game.chosen_friend
    BoxLayout:
        orientation: "vertical"
        Label:
            text: '%s' % app.metagame.game.pretty_solution

<FriendHelpPopup@Popup>:
    # auto_dismiss: False
    size_hint: 0.5, 0.5
    title: "Escolhe um amigo"
    BoxLayout:
        orientation: "vertical"
        Button:
            text: '%s' % app.metagame.game.random_friends[0]
            on_release:
                app.metagame.game.chosen_friend = app.metagame.game.random_friends[0]
                app.metagame.game.generate_random_friend_answer()
                Factory.FriendHelpAnswerPopup().open()
                root.dismiss()
        Button:
            text: '%s' % app.metagame.game.random_friends[1]
            on_release:
                app.metagame.game.chosen_friend = app.metagame.game.random_friends[1]
                app.metagame.game.generate_random_friend_answer()
                Factory.FriendHelpAnswerPopup().open()
                root.dismiss()
        Button:
            text: '%s' % app.metagame.game.random_friends[2]
            on_release:
                app.metagame.game.chosen_friend = app.metagame.game.random_friends[1]
                app.metagame.game.generate_random_friend_answer()
                Factory.FriendHelpAnswerPopup().open()
                root.dismiss()

<Game>:
    BoxLayout:
        orientation: "vertical"
        BoxLayout:
            orientation: "horizontal"
            Button:
                text: "public"
                disabled: root.help_button_disabled[self.text]
                on_release:
                    root.help(self.text)
                    Factory.PublicHelpPopup().open()
            Button:
                text: "phone"
                disabled: root.help_button_disabled[self.text]
                on_release:
                    root.help(self.text)
                    Factory.FriendHelpPopup().open()
            Button:
                text: "skip"
                disabled: root.help_button_disabled[self.text]
                on_release:
                    root.help(self.text)
            Button:
                text: "50:50"
                disabled: root.help_button_disabled[self.text]
                on_release:
                    root.help(self.text)
        Label:
            text: root.question
        BoxLayout:
            orientation: "horizontal"
            Button:
                text: "A: %s" % root.options["A"]
                disabled: root.option_button_disabled["A"]
                on_release:
                    root.current_button_selected = "A"
                    Factory.CofirmAnswerPopup().open()
            Button:
                text: "B: %s" % root.options["B"]
                disabled: root.option_button_disabled["B"]
                on_release:
                    root.current_button_selected = "B"
                    Factory.CofirmAnswerPopup().open()
        BoxLayout:
            orientation: "horizontal"
            Button:
                text: "C: %s" % root.options["C"]
                disabled: root.option_button_disabled["C"]
                on_release:
                    root.current_button_selected = "C"
                    Factory.CofirmAnswerPopup().open()
            Button:
                text: "D: %s" % root.options["D"]
                disabled: root.option_button_disabled["D"]
                on_release:
                    root.current_button_selected = "D"
                    Factory.CofirmAnswerPopup().open()

<GameOverScreen@Screen>:
    Label:
        text: "You WIN"

<MetaGame>:
    id: metagame
    game: game
    game_over_screen: game_over_screen
    Game:
        id: game
        name: "game"
        manager: metagame
    GameOverScreen:
        id: game_over_screen
        name: "game_over_screen"
        manager: metagame